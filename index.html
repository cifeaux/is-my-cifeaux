<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Is My Cifeaux? - Test Your #CCFF00 Colour Perception</title>
    <meta name="description" content="An interactive test to see if your yellow-green is close enough to the one true cifeaux (#CCFF00). Adaptive test with personality-based results.">

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-N498PE7E7L"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-N498PE7E7L');
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            margin: 0;
            padding: 0;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            position: relative;
        }

        .color-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transition: background-color 0.5s ease;
            z-index: 1;
        }

        .container {
            position: relative;
            z-index: 2;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .ui-card {
            background: white;
            color: #000;
            padding: 2.5rem 3rem;
            border-radius: 0;
            box-shadow: 6px 6px 0px rgba(0, 0, 0, 0.2);
            max-width: 600px;
            width: 100%;
            text-align: center;
            border: 3px solid #000;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.02em;

            /* White fill with black stroke - ccff00.com style */
            color: white;
            -webkit-text-fill-color: white;
            -webkit-text-stroke: 2px black;
            paint-order: stroke fill;
            filter: drop-shadow(3px 3px 0 black);
        }

        .subtitle {
            font-size: 1rem;
            color: #666;
            margin-bottom: 2rem;
            line-height: 1.5;
        }

        .question {
            font-size: 1.4rem;
            margin: 1rem 0 0.5rem;
            font-weight: 600;
            color: #000;
        }

        .subheader {
            font-size: 1rem;
            color: #666;
            font-style: italic;
            margin-bottom: 1.5rem;
            text-transform: lowercase;
        }

        .color-code {
            display: none;
        }

        .progress {
            color: #999;
            font-size: 0.9rem;
            margin: 1.5rem 0 1rem;
        }

        .button-group {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            padding: 0.9rem 2rem;
            font-size: 1rem;
            font-weight: 600;
            border: 2px solid #000;
            background: white;
            color: #000;
            cursor: pointer;
            border-radius: 0;
            transition: all 0.1s ease;
            min-width: 140px;
            text-transform: uppercase;
            letter-spacing: 0.02em;
            box-shadow: 3px 3px 0px rgba(0, 0, 0, 1);
            position: relative;
        }

        button:active {
            box-shadow: 0px 0px 0px rgba(0, 0, 0, 1);
            transform: translate(3px, 3px);
        }

        /* Hover only on devices that support hover (not touch) */
        @media (hover: hover) {
            button:hover {
                background: #000;
                border-color: #000;
                color: #fff;
                box-shadow: 0px 0px 0px rgba(0, 0, 0, 1);
                transform: translate(3px, 3px);
            }

            button.reset-btn:hover {
                background: #f0f0f0;
                border-color: #999;
                color: #000;
            }

            button.about-btn:hover {
                background: #f0f0f0;
                border-color: #999;
                color: #000;
            }

            .close-btn:hover {
                background: #f0f0f0;
                border-color: #999;
            }
        }

        button.reset-btn {
            border-color: #999;
            color: #666;
        }

        button.about-btn {
            border-color: #999;
            color: #666;
        }

        /* Results Page */
        .results {
            display: none;
            width: 100%;
            height: 100%;
            align-items: center;
            justify-content: center;
        }

        .results.active {
            display: flex;
        }

        .results-card {
            background: white;
            color: #000;
            padding: 2rem 3rem;
            border-radius: 0;
            box-shadow: 6px 6px 0px rgba(0, 0, 0, 0.2);
            border: 3px solid #000;
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .results-header {
            font-size: 1.5rem;
            margin: 0.5rem 0 1rem;
            font-weight: 700;
            color: #000;
        }

        .verdict {
            font-size: 2rem;
            margin: 0.5rem 0 0.8rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.02em;

            /* White fill with black stroke - ccff00.com style */
            color: white;
            -webkit-text-fill-color: white;
            -webkit-text-stroke: 2px black;
            paint-order: stroke fill;
            filter: drop-shadow(3px 3px 0 black);
        }

        .verdict-description {
            color: #666;
            margin-bottom: 1.5rem;
            font-size: 1rem;
            line-height: 1.6;
        }

        .gradient-container {
            margin: 2rem 0;
            position: relative;
        }

        .gradient {
            width: 100%;
            height: 80px;
            border-radius: 8px;
            position: relative;
            margin: 1rem 0;
        }

        .marker {
            position: absolute;
            top: -30px;
            transform: translateX(-50%);
            font-size: 0.85rem;
            white-space: nowrap;
            color: #666;
        }

        .marker.true-cifeaux {
            color: #000;
            font-weight: 700;
            font-size: 1rem;
        }

        .marker::after {
            content: '▼';
            display: block;
            text-align: center;
        }

        .range-indicator {
            position: absolute;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid #fff;
            border-radius: 4px;
            top: 0;
        }

        .boundary-note {
            margin: 1.5rem 0;
            padding: 1.5rem;
            background: #f9f9f9;
            border-radius: 0;
            border: 2px solid #000;
            text-align: left;
        }

        .boundary-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 0.8rem;
            color: #000;
        }

        .boundary-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: #000;
            margin: 0.5rem 0;
            font-family: 'Courier New', monospace;
        }

        .boundary-text {
            color: #666;
            line-height: 1.6;
            margin-top: 0.8rem;
            font-size: 0.95rem;
        }

        .stats {
            margin: 2rem 0;
            padding: 1.5rem;
            background: #f9f9f9;
            border-radius: 0;
            border: 1px solid #e0e0e0;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin: 0.8rem 0;
            font-size: 0.95rem;
        }

        .stat-label {
            color: #666;
        }

        .stat-value {
            color: #000;
            font-weight: 600;
        }

        .cta {
            margin-top: 2rem;
            padding: 1.5rem;
            background: #f5f5f5;
            border-radius: 0;
            border: 2px solid #000;
        }

        .cta-title {
            font-size: 1.2rem;
            margin-bottom: 0.8rem;
            color: #000;
            font-weight: 600;
        }

        .cta-text {
            color: #666;
            margin-bottom: 1.2rem;
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .cta-link {
            color: #000;
            text-decoration: none;
            font-weight: 600;
            border-bottom: 2px solid #000;
            transition: opacity 0.2s;
        }

        .cta-link:hover {
            opacity: 0.7;
        }

        .test-screen {
            display: none;
            width: 100%;
            height: 100%;
            align-items: center;
            justify-content: center;
        }

        .test-screen.active {
            display: flex;
        }

        footer {
            margin-top: 1.5rem;
            color: #999;
            font-size: 0.85rem;
        }

        footer a {
            color: #666;
            text-decoration: none;
            border-bottom: 1px solid #ccc;
        }

        footer a:hover {
            color: #000;
            border-bottom-color: #000;
        }

        /* Error Modal */
        .error-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            backdrop-filter: blur(8px);
        }

        .error-modal.active {
            display: flex;
        }

        .error-content {
            max-width: 500px;
            background: white;
            padding: 2rem;
            border-radius: 0;
            border: 3px solid #000;
            box-shadow: 6px 6px 0px rgba(0, 0, 0, 0.2);
        }

        .error-title {
            color: #000;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .error-text {
            color: #666;
            line-height: 1.6;
            margin-bottom: 2rem;
        }

        /* About Modal */
        .about-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-y: auto;
            backdrop-filter: blur(8px);
        }

        .about-modal.active {
            display: flex;
        }

        .about-content {
            max-width: 700px;
            background: white;
            padding: 2.5rem;
            border-radius: 0;
            box-shadow: 6px 6px 0px rgba(0, 0, 0, 0.2);
            border: 3px solid #000;
            max-height: 90vh;
            overflow-y: auto;
        }

        .about-content h2 {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.02em;

            /* White fill with black stroke - ccff00.com style */
            color: white;
            -webkit-text-fill-color: white;
            -webkit-text-stroke: 2px black;
            paint-order: stroke fill;
            filter: drop-shadow(3px 3px 0 black);
        }

        .about-content h3 {
            color: #000;
            font-size: 1.2rem;
            margin: 2rem 0 1rem;
            font-weight: 600;
        }

        .about-content p {
            color: #666;
            line-height: 1.7;
            margin-bottom: 1rem;
        }

        .about-content a {
            color: #000;
            text-decoration: none;
            border-bottom: 2px solid #000;
        }

        .about-content a:hover {
            opacity: 0.7;
        }

        .close-btn {
            background: white;
            border: 2px solid #ccc;
            color: #666;
            padding: 0.8rem 2rem;
            margin-top: 1.5rem;
        }

        /* Confetti */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #CCFF00;
            position: absolute;
            animation: confetti-fall 3s linear forwards;
            z-index: 999;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }

        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        @media (max-width: 600px) {
            .ui-card, .results-card {
                padding: 1.5rem;
                margin: 10px;
            }

            .button-group {
                flex-direction: column;
                gap: 0.8rem;
            }

            button {
                width: 100%;
            }

            .about-content, .error-content {
                padding: 1.5rem;
                margin: 10px;
            }

            h1 {
                font-size: 1.5rem;
            }

            .question {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Full screen color background -->
    <div class="color-background" id="colorBackground"></div>

    <div class="container">
        <!-- Test Screen -->
        <div class="test-screen active">
            <div class="ui-card">
                <h1>Is My Cifeaux?</h1>
           <p class="question"> Test your <a href="https://www.ccff00.com" target="_blank" rel="noopener noreferrer" style="color:#000; text-decoration:none;">#CCFF00</a> perception</p>
                <p class="subheader">is MY cifeaux, YOUR cifeaux?</p>
                <div class="button-group">
                    <button onclick="answer(true)">This is cifeaux</button>
                    <button onclick="answer(false)">This is not cifeaux</button>
                </div>
                <p class="progress" id="progress"></p>
                <div class="button-group">
                    <button class="reset-btn" onclick="resetTest()">Reset</button>
                </div>
            </div>
        </div>

        <!-- Results Screen -->
        <div class="results">
            <div class="results-card">
            <h1>Is My Cifeaux?</h1>
            <h2 class="results-header">Your results:</h2>
            <h3 class="verdict" id="verdict"></h3>
            <p class="verdict-description" id="verdictDesc"></p>

            <div class="boundary-note" id="boundaryNote">
                <div class="boundary-title">Your Yellow-Green Boundary</div>
                <div class="boundary-value" id="boundaryValue"></div>
                <div class="boundary-text" id="boundaryText"></div>
            </div>

            <div class="gradient-container">
                <div class="gradient" id="gradient">
                    <div class="marker true-cifeaux" style="left: 50%;">
                        True Cifeaux<br>#CCFF00
                    </div>
                    <div class="range-indicator" id="userRange"></div>
                </div>
            </div>

            <div class="button-group">
                <button onclick="resetTest()">Reset</button>
                <button class="about-btn" onclick="showAbout()">About</button>
            </div>

            <footer>
                Inspired by <a href="https://ismy.blue/" target="_blank">ismy.blue</a> •
                Part of the <a href="https://ccff00.com" target="_blank">CCFF00</a> brand
            </footer>
            </div>
        </div>

        <!-- Error Modal -->
        <div class="error-modal" id="errorModal">
            <div class="error-content">
                <div class="error-title">Hold up.</div>
                <p class="error-text">
                    The first color is always <strong>obviously</strong> yellow or green—like, you shouldn't even have to think about it.
                    If you missed this one, either your screen is way off, you've got night mode on, or you're just messing with me.
                    <br><br>
                    Try again?
                </p>
                <button onclick="closeError()" class="close-btn" style="width: 100%;">Reset Test</button>
            </div>
        </div>

        <!-- About Modal -->
        <div class="about-modal" id="aboutModal">
            <div class="about-content">
                <h2>About This Test</h2>

                <p>People name colors differently. Language, culture, and perception all play a role in where you draw the line between "yellow" and "green." This test measures your personal yellow-green boundary around <strong>#CCFF00</strong>—the one true cifeaux.</p>

                <h3>Is This Real Science?</h3>
                <p>Nope. This is for fun.</p>

                <p>Real vision scientists use calibrated equipment. Designers use Pantone cards. Here, I'm using your phone or monitor, which is... not that. Your screen calibration, lighting, and night mode all mess with the results. But if you test on the same device in the same light, your results should be pretty consistent. Try it a few times and see.</p>

                <p>Getting weird results doesn't mean your eyes are broken. It might mean you name colors differently than most people, or your setup is unusual. Either way, it's interesting.</p>

                <h3>How It Works</h3>
                <p>The test shows you colors sequentially in the yellow-green range. It's looking for the point where you stop calling things "cifeaux" and start rejecting them.</p>

                <p>Behind the scenes, it's fitting a curve to your answers (like a logistic regression). It doesn't just do a binary search—it samples intelligently based on where you seem uncertain. Even if you feel like you're guessing in the middle, the math should handle it.</p>

                <h3>Why This Exists</h3>
                <p>Because I'm trying to <strong>own a color</strong>. Not just use it—<em>own</em> it. Culturally. Commercially. Creatively.</p>

                <p>This is part of the <a href="https://ccff00.com" target="_blank">CCFF00 project</a>: proof that one person with AI, agency, and unreasonable commitment can claim a color the way brands claim red or blue.</p>

                <p>If not me, who? If not now, when?</p>

                <h3>Who Made This?</h3>
                <p>Kade Blaze (<a href="https://ccff00.com" target="_blank">CCFF00</a>). Built with Claude Code. Inspired by <a href="https://ismy.blue" target="_blank">ismy.blue</a> by Patrick Mineault.</p>

                <button onclick="closeAbout()" class="close-btn">Close</button>
            </div>
        </div>
    </div>

    <script>
        // Adaptive colour pool - organized by spectrum position
        // Wider range from yellow to green
        const colourPool = {
            veryYellow: [
                { hex: '#EEFF00', name: 'Very Yellow', value: 0 },
                { hex: '#E5FF00', name: 'Bright Yellow', value: 1 },
                { hex: '#DDFF00', name: 'Electric Yellow', value: 2 }
            ],
            yellow: [
                { hex: '#D8FF00', name: 'Light Yellow', value: 3 },
                { hex: '#D3FF00', name: 'Soft Yellow', value: 4 },
                { hex: '#CEFF00', name: 'Yellow Edge', value: 5 }
            ],
            cifeaux: [
                { hex: '#CCFF00', name: 'True Cifeaux', value: 6 }
            ],
            green: [
                { hex: '#C5FF00', name: 'Yellow-Green', value: 7 },
                { hex: '#BEFF00', name: 'Lime', value: 8 },
                { hex: '#B7FF00', name: 'Chartreuse', value: 9 }
            ],
            veryGreen: [
                { hex: '#B0FF00', name: 'Bright Lime', value: 10 },
                { hex: '#A9FF00', name: 'Spring Green', value: 11 },
                { hex: '#99FF00', name: 'Very Green', value: 12 }
            ]
        };

        let currentQuestion = 0;
        let maxQuestions = 6;
        let answers = [];
        let shownColours = [];
        let userBias = 0; // Tracks if user leans yellow (negative) or green (positive)

        function resetTest() {
            currentQuestion = 0;
            answers = [];
            shownColours = [];
            userBias = 0;

            document.querySelector('.results').classList.remove('active');
            document.querySelector('.test-screen').classList.add('active');

            showColour();
        }

        function showAbout() {
            document.getElementById('aboutModal').classList.add('active');
        }

        function closeAbout() {
            document.getElementById('aboutModal').classList.remove('active');
        }

        function showError() {
            document.getElementById('errorModal').classList.add('active');
        }

        function closeError() {
            document.getElementById('errorModal').classList.remove('active');
            resetTest();
        }

        function selectColourAdaptively() {
            let colour;

            if (currentQuestion === 0) {
                // Start with obviously very yellow or very green (50/50 chance)
                const pool = Math.random() > 0.5 ? colourPool.veryYellow : colourPool.veryGreen;
                colour = pool[Math.floor(Math.random() * pool.length)];
            } else if (currentQuestion === 1) {
                // Second question: go yellow
                colour = colourPool.yellow[Math.floor(Math.random() * colourPool.yellow.length)];
            } else if (currentQuestion === 2) {
                // Third question: go green
                colour = colourPool.green[Math.floor(Math.random() * colourPool.green.length)];
            } else {
                // Adaptive selection based on previous answers
                if (userBias < -1) {
                    // User is saying yellow shades are cifeaux, show very yellow
                    colour = colourPool.veryYellow[Math.floor(Math.random() * colourPool.veryYellow.length)];
                } else if (userBias > 1) {
                    // User is saying green shades are cifeaux, show very green
                    colour = colourPool.veryGreen[Math.floor(Math.random() * colourPool.veryGreen.length)];
                } else if (userBias < 0) {
                    // Slight yellow bias
                    colour = colourPool.yellow[Math.floor(Math.random() * colourPool.yellow.length)];
                } else if (userBias > 0) {
                    // Slight green bias
                    colour = colourPool.green[Math.floor(Math.random() * colourPool.green.length)];
                } else {
                    // No bias, show cifeaux again or random mid-range
                    const pool = Math.random() > 0.5 ? colourPool.yellow : colourPool.green;
                    colour = pool[Math.floor(Math.random() * pool.length)];
                }
            }

            // Ensure we don't show the same colour twice
            while (shownColours.includes(colour.hex)) {
                const allColours = [
                    ...colourPool.veryYellow,
                    ...colourPool.yellow,
                    ...colourPool.cifeaux,
                    ...colourPool.green,
                    ...colourPool.veryGreen
                ];
                colour = allColours[Math.floor(Math.random() * allColours.length)];
            }

            return colour;
        }

        function showColour() {
            const colour = selectColourAdaptively();
            shownColours.push(colour.hex);

            // Set background color
            document.getElementById('colorBackground').style.background = colour.hex;
            document.getElementById('progress').textContent = `${currentQuestion + 1} of ${maxQuestions}`;

            // Store current colour for answer processing
            window.currentColour = colour;
        }

        function answer(isCifeaux) {
            const colour = window.currentColour;

            // Check if first question was answered incorrectly (obvious extremes)
            if (currentQuestion === 0) {
                const isExtreme = colour.value <= 2 || colour.value >= 10;
                if (isExtreme && isCifeaux) {
                    // They called an obvious extreme "cifeaux" - show error
                    showError();
                    return;
                }
            }

            // Track answer
            answers.push({
                colour: colour.hex,
                value: colour.value,
                isCifeaux: isCifeaux
            });

            // Update bias based on answer
            if (isCifeaux) {
                if (colour.value < 6) {
                    // Accepted a yellow shade
                    userBias -= 1;
                } else if (colour.value > 6) {
                    // Accepted a green shade
                    userBias += 1;
                }
            }

            // Track individual answer
            gtag('event', 'answer', {
                'event_category': 'test',
                'event_label': colour.hex,
                'value': isCifeaux ? 1 : 0
            });

            currentQuestion++;

            if (currentQuestion < maxQuestions) {
                showColour();
            } else {
                showResults();
            }
        }

        function createConfetti() {
            const colors = ['#CCFF00', '#CCFF00', '#DDFF00', '#BBFF00', '#CCFF00']; // Mostly cifeaux
            const confettiCount = 50;

            for (let i = 0; i < confettiCount; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.width = (Math.random() * 8 + 6) + 'px';
                    confetti.style.height = confetti.style.width;
                    confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    confetti.style.animationDelay = (Math.random() * 0.5) + 's';

                    document.body.appendChild(confetti);

                    setTimeout(() => {
                        confetti.remove();
                    }, 4000);
                }, i * 30);
            }
        }

        function showResults() {
            // Hide test, show results
            document.querySelector('.test-screen').classList.remove('active');
            document.querySelector('.results').classList.add('active');

            // Set background to average accepted color or cifeaux
            const yesAnswers = answers.filter(a => a.isCifeaux);
            if (yesAnswers.length > 0) {
                const avgValue = yesAnswers.reduce((sum, a) => sum + a.value, 0) / yesAnswers.length;
                const allColours = [
                    ...colourPool.veryYellow,
                    ...colourPool.yellow,
                    ...colourPool.cifeaux,
                    ...colourPool.green,
                    ...colourPool.veryGreen
                ];
                const closestColor = allColours.reduce((prev, curr) =>
                    Math.abs(curr.value - avgValue) < Math.abs(prev.value - avgValue) ? curr : prev
                );
                document.getElementById('colorBackground').style.background = closestColor.hex;
            } else {
                document.getElementById('colorBackground').style.background = '#CCFF00';
            }

            // Trigger confetti
            createConfetti();

            // Calculate results (yesAnswers already calculated above)
            const acceptedCount = yesAnswers.length;

            // Find range boundaries (values, not indices)
            let minValue = yesAnswers.length > 0 ? Math.min(...yesAnswers.map(a => a.value)) : -1;
            let maxValue = yesAnswers.length > 0 ? Math.max(...yesAnswers.map(a => a.value)) : -1;

            // Determine verdict
            let verdict, description, verdictType;

            if (acceptedCount === 0) {
                verdict = "The Skeptic";
                verdictType = "skeptic";
                description = "Not a single shade passed your test. You're either a purist with impossible standards or you're trolling. Either way, respect the commitment.";
            } else if (acceptedCount === 1 && yesAnswers[0].hex === '#CCFF00') {
                verdict = "The Purist";
                verdictType = "purist";
                description = "You accept only #CCFF00 and nothing else. You understand that cifeaux is not a range—it's a religion.";
            } else if (acceptedCount <= 2) {
                verdict = "The Connoisseur";
                verdictType = "connoisseur";
                description = "You have refined taste and strict boundaries. You know cifeaux when you see it, and you're not easily fooled.";
            } else if (acceptedCount <= 4) {
                verdict = "The Pragmatist";
                verdictType = "pragmatist";
                description = "You understand that cifeaux is a vibe, not just a hex code. There's room for interpretation, but you still have standards.";
            } else if (acceptedCount <= 5) {
                verdict = "The Expansionist";
                verdictType = "expansionist";
                description = "Your cifeaux territory is broad. You see the family resemblance across the yellow-green spectrum. Bold.";
            } else {
                verdict = "The Visionary";
                verdictType = "visionary";
                description = "Every shade is cifeaux if you believe hard enough. You're either colourblind or operating on a higher plane of consciousness.";
            }

            document.getElementById('verdict').textContent = verdict;
            document.getElementById('verdictDesc').textContent = description;

            // Display range on gradient (normalized to 0-100%)
            if (minValue >= 0 && maxValue >= 0) {
                const minPercent = (minValue / 12) * 100; // 12 is max value
                const maxPercent = (maxValue / 12) * 100;
                const rangeWidth = maxPercent - minPercent;

                const rangeEl = document.getElementById('userRange');
                rangeEl.style.left = minPercent + '%';
                rangeEl.style.width = Math.max(rangeWidth, 3) + '%';
            }

            // Calculate boundary
            const avgValue = yesAnswers.length > 0
                ? yesAnswers.reduce((sum, a) => sum + a.value, 0) / yesAnswers.length
                : 6;

            // Bias calculation (for database)
            let bias;
            if (avgValue < 5) {
                bias = "More yellow";
            } else if (avgValue > 7) {
                bias = "More green";
            } else {
                bias = "Perfectly balanced";
            }

            // Create gradient spanning full spectrum
            const allColours = [
                ...colourPool.veryYellow,
                ...colourPool.yellow,
                ...colourPool.cifeaux,
                ...colourPool.green,
                ...colourPool.veryGreen
            ].sort((a, b) => a.value - b.value);

            const gradientStops = allColours.map((c, i) => {
                const position = (c.value / 12) * 100;
                return `${c.hex} ${position}%`;
            }).join(', ');

            document.getElementById('gradient').style.background = `linear-gradient(to right, ${gradientStops})`;

            // Calculate and display boundary
            const boundaryColor = allColours.reduce((prev, curr) =>
                Math.abs(curr.value - avgValue) < Math.abs(prev.value - avgValue) ? curr : prev
            );

            document.getElementById('boundaryValue').textContent = boundaryColor.hex;

            let boundaryText = '';
            if (acceptedCount === 0) {
                boundaryText = "You rejected everything. Either you're impossible to please or your screen is lying to you.";
            } else if (acceptedCount === 1 && yesAnswers[0].hex === '#CCFF00') {
                boundaryText = "Your boundary is exactly #CCFF00. Purist energy.";
            } else if (avgValue < 6) {
                const yellowness = Math.round(((6 - avgValue) / 6) * 100);
                boundaryText = `You lean yellow. Your cifeaux threshold is ${yellowness}% more yellow than true #CCFF00.`;
            } else if (avgValue > 6) {
                const greenness = Math.round(((avgValue - 6) / 6) * 100);
                boundaryText = `You lean green. Your cifeaux threshold is ${greenness}% more green than true #CCFF00.`;
            } else {
                boundaryText = "Your boundary is perfectly centered on #CCFF00. Rare.";
            }

            document.getElementById('boundaryText').textContent = boundaryText;

            // Save results to database
            saveResults({
                verdict: verdictType,
                acceptedCount: acceptedCount,
                bias: bias,
                answers: answers,
                timestamp: new Date().toISOString()
            });

            // Track completion
            gtag('event', 'test_complete', {
                'event_category': 'engagement',
                'event_label': verdictType,
                'value': acceptedCount
            });
        }

        function saveResults(data) {
            // Send results to PHP backend
            fetch('save-results.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(result => {
                console.log('Results saved:', result);
            })
            .catch(error => {
                console.error('Error saving results:', error);
            });
        }

        // Auto-start test on page load
        window.addEventListener('DOMContentLoaded', function() {
            // Track start event
            gtag('event', 'test_start', {
                'event_category': 'engagement'
            });

            showColour();
        });
    </script>
</body>
</html>
